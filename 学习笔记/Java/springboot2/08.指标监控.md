
# 08、指标监控

# 1、SpringBoot Actuator  

## 1、简介  

未来每一个微服务在云上部署以后，我们都需要对其进行监控、追踪、审计、控制等。SpringBoot就抽取了Actuator场景，使得我们每个微服务快速引用即可获得生产级别的应用监控、审计等功能。  

```xml
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
```

![image.png](./08.%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.assets/202201201000791.png)

## 2、1.x与2.x的不同

![image.png](./08.%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.assets/202201201000731.png)

## 3、如何使用  

●引入场景 
●访问 [http://localhost:8080/actuator/](http://localhost:8080/actuator/)\*\* 
●暴露所有监控信息为HTTP  

```yaml
management:
  endpoints:
    enabled-by-default: true #暴露所有端点信息
    web:
      exposure:
        include: '*'  #以web方式暴露
```

●测试 
[http://localhost:8080/actuator/beans](http://localhost:8080/actuator/beans) 
[http://localhost:8080/actuator/configprops](http://localhost:8080/actuator/configprops) 
[http://localhost:8080/actuator/metrics](http://localhost:8080/actuator/metrics) 
[http://localhost:8080/actuator/metrics/jvm.gc.pause](http://localhost:8080/actuator/metrics/jvm.gc.pause) 
[http://localhost:8080/actuator/](http://localhost:8080/actuator/metrics)endpointName/detailPath 。。。。。。  

## 4、可视化  

[https://github.com/codecentric/spring-boot-admin](https://github.com/codecentric/spring-boot-admin)  

# 2、Actuator Endpoint  

## 1、最常使用的端点  


<table class="ne-table" style="width: 751px;"><colgroup><col width="275"><col width="475"></colgroup><tbody class="ne-table-inner"><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="ue7320d2b" data-lake-id="ue7320d2b" ne-alignment="left"><ne-text>ID</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="u517374ef" data-lake-id="u517374ef" ne-alignment="left"><ne-text>描述</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="b3368687d088517e56889aafde6977d1" data-lake-id="b3368687d088517e56889aafde6977d1" ne-alignment="left"><ne-code><ne-code-content><ne-text>auditevents</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="de0606450bb05a20bc1275c8fff72cb3" data-lake-id="de0606450bb05a20bc1275c8fff72cb3" ne-alignment="left"><ne-text>暴露当前应用程序的审核事件信息。需要一个</ne-text><ne-code><ne-code-content><ne-text>AuditEventRepository组件</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="97cc14f8234287b5b4f648d118756fa2" data-lake-id="97cc14f8234287b5b4f648d118756fa2" ne-alignment="left"><ne-code><ne-code-content><ne-text>beans</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e750d149f669aafd553acd975ed0ccdd" data-lake-id="e750d149f669aafd553acd975ed0ccdd" ne-alignment="left"><ne-text>显示应用程序中所有Spring Bean的完整列表。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="2d845e35c395d2e92325d8562e44f391" data-lake-id="2d845e35c395d2e92325d8562e44f391" ne-alignment="left"><ne-code><ne-code-content><ne-text>caches</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="455737fc989ac6af87e96dae27bfcab6" data-lake-id="455737fc989ac6af87e96dae27bfcab6" ne-alignment="left"><ne-text>暴露可用的缓存。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="66c1c7f4d42b6c151416b25be4db9d80" data-lake-id="66c1c7f4d42b6c151416b25be4db9d80" ne-alignment="left"><ne-code><ne-code-content><ne-text>conditions</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1"><div class="ne-td-content"><ne-p id="eb4465bb517ea14c2fdd89997e8afcfe" data-lake-id="eb4465bb517ea14c2fdd89997e8afcfe"><ne-text>显示自动配置的所有条件信息，包括匹配或不匹配的原因。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="b1b846d7cd95e3705b8b8c7bc456d448" data-lake-id="b1b846d7cd95e3705b8b8c7bc456d448" ne-alignment="left"><ne-code><ne-code-content><ne-text>configprops</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="98b450f345b2371abbca9f872a6551ca" data-lake-id="98b450f345b2371abbca9f872a6551ca" ne-alignment="left"><ne-text>显示所有</ne-text><ne-code><ne-code-content><ne-text>@ConfigurationProperties</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d834d9d93f109dfb9c0cc997d50a1853" data-lake-id="d834d9d93f109dfb9c0cc997d50a1853" ne-alignment="left"><ne-code><ne-code-content><ne-text>env</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="1aecca5671d01ea502f81054821db640" data-lake-id="1aecca5671d01ea502f81054821db640" ne-alignment="left"><ne-text>暴露Spring的属性</ne-text><ne-code><ne-code-content><ne-text>ConfigurableEnvironment</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="fa5b01a3a28869990c60f86b0f2a9bf2" data-lake-id="fa5b01a3a28869990c60f86b0f2a9bf2" ne-alignment="left"><ne-code><ne-code-content><ne-text>flyway</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="7bc291b603c6c5ced14780a7809ed9d2" data-lake-id="7bc291b603c6c5ced14780a7809ed9d2" ne-alignment="left"><ne-text>显示已应用的所有Flyway数据库迁移。 </ne-text><ne-text>需要一个或多个</ne-text><ne-code><ne-code-content><ne-text>Flyway</ne-text></ne-code-content></ne-code><ne-text>组件。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="a2af88f9e32b28a00bb6b35168d5ea40" data-lake-id="a2af88f9e32b28a00bb6b35168d5ea40" ne-alignment="left"><ne-code><ne-code-content><ne-text>health</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="c42e6c259ef4cf4c833cc4787bacbda0" data-lake-id="c42e6c259ef4cf4c833cc4787bacbda0" ne-alignment="left"><ne-text>显示应用程序运行状况信息。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="ddc38a97703c8248126729aa9a4f4b70" data-lake-id="ddc38a97703c8248126729aa9a4f4b70" ne-alignment="left"><ne-code><ne-code-content><ne-text>httptrace</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="db7c8bede3305fc37434ae594048f2f1" data-lake-id="db7c8bede3305fc37434ae594048f2f1" ne-alignment="left"><ne-text>显示HTTP跟踪信息（默认情况下，最近100个HTTP请求-响应）。需要一个</ne-text><ne-code><ne-code-content><ne-text>HttpTraceRepository</ne-text></ne-code-content></ne-code><ne-text>组件。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e77587b724577b7b01e2471bf699a3dd" data-lake-id="e77587b724577b7b01e2471bf699a3dd" ne-alignment="left"><ne-code><ne-code-content><ne-text>info</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="fc566709fc2158ccddea69dd1974cb57" data-lake-id="fc566709fc2158ccddea69dd1974cb57" ne-alignment="left"><ne-text>显示应用程序信息。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="57fc55ae8fc555324366e2202299f20b" data-lake-id="57fc55ae8fc555324366e2202299f20b" ne-alignment="left"><ne-code><ne-code-content><ne-text>integrationgraph</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="83d99573a8c3d59b19607e75ab6df2e3" data-lake-id="83d99573a8c3d59b19607e75ab6df2e3" ne-alignment="left"><ne-text>显示Spring&nbsp;</ne-text><ne-code><ne-code-content><ne-text>integrationgraph</ne-text></ne-code-content></ne-code><ne-text> 。需要依赖</ne-text><ne-code><ne-code-content><ne-text>spring-integration-core</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="8fa22bac8d533c2fb189cb4c64e7ec7e" data-lake-id="8fa22bac8d533c2fb189cb4c64e7ec7e" ne-alignment="left"><ne-code><ne-code-content><ne-text>loggers</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="cb098e3ae396b53ec51337cf863bcd2c" data-lake-id="cb098e3ae396b53ec51337cf863bcd2c" ne-alignment="left"><ne-text>显示和修改应用程序中日志的配置。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="cb70a8e943c1c77ef73505c73f56734f" data-lake-id="cb70a8e943c1c77ef73505c73f56734f" ne-alignment="left"><ne-code><ne-code-content><ne-text>liquibase</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="3db44602e6a78ab05563330a71f07f74" data-lake-id="3db44602e6a78ab05563330a71f07f74" ne-alignment="left"><ne-text>显示已应用的所有Liquibase数据库迁移。需要一个或多个</ne-text><ne-code><ne-code-content><ne-text>Liquibase</ne-text></ne-code-content></ne-code><ne-text>组件。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="5ed6b84f57746e6f4950077be2836d35" data-lake-id="5ed6b84f57746e6f4950077be2836d35" ne-alignment="left"><ne-code><ne-code-content><ne-text>metrics</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="8bb5a83a8173e2477cb9d656e28d0aaa" data-lake-id="8bb5a83a8173e2477cb9d656e28d0aaa" ne-alignment="left"><ne-text>显示当前应用程序的“指标”信息。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d8488a1895d603d6e0c8f968e49504b7" data-lake-id="d8488a1895d603d6e0c8f968e49504b7" ne-alignment="left"><ne-code><ne-code-content><ne-text>mappings</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="057d7e7ecd4fe1c4a4d438efa06aa987" data-lake-id="057d7e7ecd4fe1c4a4d438efa06aa987" ne-alignment="left"><ne-text>显示所有</ne-text><ne-code><ne-code-content><ne-text>@RequestMapping</ne-text></ne-code-content></ne-code><ne-text>路径列表。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="2c40dd0cdc342722b97a2eaf560978c7" data-lake-id="2c40dd0cdc342722b97a2eaf560978c7" ne-alignment="left"><ne-code><ne-code-content><ne-text>scheduledtasks</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d9fcfd04b7a33106b6dac3016b83c9c0" data-lake-id="d9fcfd04b7a33106b6dac3016b83c9c0" ne-alignment="left"><ne-text>显示应用程序中的计划任务。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="4ff1f26db71134f9552430191398dbbc" data-lake-id="4ff1f26db71134f9552430191398dbbc" ne-alignment="left"><ne-code><ne-code-content><ne-text>sessions</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="fdd861953244dba1e13560b7ff0c2831" data-lake-id="fdd861953244dba1e13560b7ff0c2831" ne-alignment="left"><ne-text>允许从Spring Session支持的会话存储中检索和删除用户会话。需要使用Spring Session的基于Servlet的Web应用程序。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="3b0e678e540b1da7e768e287445989c3" data-lake-id="3b0e678e540b1da7e768e287445989c3" ne-alignment="left"><ne-code><ne-code-content><ne-text>shutdown</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e6d7db11d2880b025220b612991f24cf" data-lake-id="e6d7db11d2880b025220b612991f24cf" ne-alignment="left"><ne-text>使应用程序正常关闭。默认禁用。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="818b951259d99edc64ea5600215ffff8" data-lake-id="818b951259d99edc64ea5600215ffff8" ne-alignment="left"><ne-code><ne-code-content><ne-text>startup</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="42421bd4aa1ddb42385ca6843d17d239" data-lake-id="42421bd4aa1ddb42385ca6843d17d239" ne-alignment="left"><ne-text>显示由</ne-text><ne-code><ne-code-content><ne-text>ApplicationStartup</ne-text></ne-code-content></ne-code><ne-text>收集的启动步骤数据。需要使用</ne-text><ne-code><ne-code-content><ne-text>SpringApplication</ne-text></ne-code-content></ne-code><ne-text>进行配置</ne-text><ne-code><ne-code-content><ne-text>BufferingApplicationStartup</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="5de0f1c89bf73d74f40b253dec5822f3" data-lake-id="5de0f1c89bf73d74f40b253dec5822f3" ne-alignment="left"><ne-code><ne-code-content><ne-text>threaddump</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="0f7fe014cd566e2896c2013b7a0614fe" data-lake-id="0f7fe014cd566e2896c2013b7a0614fe" ne-alignment="left"><ne-text>执行线程转储。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr></tbody></table>

  

如果您的应用程序是Web应用程序（Spring MVC，Spring WebFlux或Jersey），则可以使用以下附加端点：  

<table class="ne-table" style="width: 720px;"><colgroup><col width="244"><col width="475"></colgroup><tbody class="ne-table-inner"><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="ue8d9a86c" data-lake-id="ue8d9a86c" ne-alignment="left"><ne-text>ID</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="u9fb4e572" data-lake-id="u9fb4e572" ne-alignment="left"><ne-text>描述</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="862050e4a58ee933ffc3b7d617a26019" data-lake-id="862050e4a58ee933ffc3b7d617a26019" ne-alignment="left"><ne-code><ne-code-content><ne-text>heapdump</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="084973bb63cdd6937d4b278f5efa4f01" data-lake-id="084973bb63cdd6937d4b278f5efa4f01" ne-alignment="left"><ne-text>返回</ne-text><ne-code><ne-code-content><ne-text>hprof</ne-text></ne-code-content></ne-code><ne-text>堆转储文件。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="f704cf4700b977d98b76d17fba8f94ca" data-lake-id="f704cf4700b977d98b76d17fba8f94ca" ne-alignment="left"><ne-code><ne-code-content><ne-text>jolokia</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="250c1b4743c97e365f1e2a3a15260b51" data-lake-id="250c1b4743c97e365f1e2a3a15260b51" ne-alignment="left"><ne-text>通过HTTP暴露JMX bean（需要引入Jolokia，不适用于WebFlux）。需要引入依赖</ne-text><ne-code><ne-code-content><ne-text>jolokia-core</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="84668e8d7b4943d056088861d7ed004c" data-lake-id="84668e8d7b4943d056088861d7ed004c" ne-alignment="left"><ne-code><ne-code-content><ne-text>logfile</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="940f6d1ba383e193cf79cb615ee66b80" data-lake-id="940f6d1ba383e193cf79cb615ee66b80" ne-alignment="left"><ne-text>返回日志文件的内容（如果已设置</ne-text><ne-code><ne-code-content><ne-text>logging.file.name</ne-text></ne-code-content></ne-code><ne-text>或</ne-text><ne-code><ne-code-content><ne-text>logging.file.path</ne-text></ne-code-content></ne-code><ne-text>属性）。支持使用HTTP</ne-text><ne-code><ne-code-content><ne-text>Range</ne-text></ne-code-content></ne-code><ne-text>标头来检索部分日志文件的内容。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="54f19d440fc7154ad4c09ba35a3f9ff2" data-lake-id="54f19d440fc7154ad4c09ba35a3f9ff2" ne-alignment="left"><ne-code><ne-code-content><ne-text>prometheus</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="91de80c13f96339cbba72955c18d0919" data-lake-id="91de80c13f96339cbba72955c18d0919" ne-alignment="left"><ne-text>以Prometheus服务器可以抓取的格式公开指标。需要依赖</ne-text><ne-code><ne-code-content><ne-text>micrometer-registry-prometheus</ne-text></ne-code-content></ne-code><ne-text>。</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr></tbody></table>

  

最常用的Endpoint 
●Health：监控状况 
●Metrics：运行时指标 
●Loggers：日志记录  

## 2、Health Endpoint  

健康检查端点，我们一般用于在云平台，平台会定时的检查应用的健康状况，我们就需要Health Endpoint可以为平台返回当前应用的一系列组件健康状况的集合。 
重要的几点： 
●health endpoint返回的结果，应该是一系列健康检查后的一个汇总报告 
●很多的健康检查默认已经自动配置好了，比如：数据库、redis等 
●可以很容易的添加自定义的健康检查机制  

![image.png](./08.%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.assets/202201201001047.png)

## 3、Metrics Endpoint  

提供详细的、层级的、空间指标信息，这些信息可以被pull（主动推送）或者push（被动获取）方式得到； 
●通过Metrics对接多种监控系统 
●简化核心Metrics开发 
●添加自定义Metrics或者扩展已有Metrics  


![image.png](./08.%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.assets/202201201001909.png)

## 4、管理Endpoints

### 1、开启与禁用Endpoints

●默认所有的Endpoint除过shutdown都是开启的。 
●需要开启或者禁用某个Endpoint。配置模式为 management.endpoint.<endpointName>.enabled = true  

```yaml
management:
  endpoint:
    beans:
      enabled: true
```

●或者禁用所有的Endpoint然后手动开启指定的Endpoint  

```yaml
management:
  endpoints:
    enabled-by-default: false
  endpoint:
    beans:
      enabled: true
    health:
      enabled: true
```

### 2、暴露Endpoints  

支持的暴露方式 
●HTTP：默认只暴露health和info Endpoint 
●JMX：默认暴露所有Endpoint 
●除过health和info，剩下的Endpoint都应该进行保护访问。如果引入SpringSecurity，则会默认配置安全访问规则  

<table class="ne-table" style="width: 604px;"><colgroup><col width="234"><col width="184"><col width="185"></colgroup><tbody class="ne-table-inner"><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="u9c7c0e63" data-lake-id="u9c7c0e63" ne-alignment="left"><ne-text>ID</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="ub5d6ba66" data-lake-id="ub5d6ba66" ne-alignment="left"><ne-text>JMX</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="u1f10a982" data-lake-id="u1f10a982" ne-alignment="left"><ne-text>Web</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="14aabfdcf4f25a2970c96cc0866e4d70" data-lake-id="14aabfdcf4f25a2970c96cc0866e4d70" ne-alignment="left"><ne-code><ne-code-content><ne-text>auditevents</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="f86dd49c716f29bea458535defac67f7" data-lake-id="f86dd49c716f29bea458535defac67f7" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="8610da0a4c4cca6464fc5421820bd206" data-lake-id="8610da0a4c4cca6464fc5421820bd206" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="8f5abf8aee87302f89e81c3c6ccad565" data-lake-id="8f5abf8aee87302f89e81c3c6ccad565" ne-alignment="left"><ne-code><ne-code-content><ne-text>beans</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="59e51321b05548230ccc552da14e716a" data-lake-id="59e51321b05548230ccc552da14e716a" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="abc26de582c81b0d235e6e6e7c9bd2cf" data-lake-id="abc26de582c81b0d235e6e6e7c9bd2cf" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="a73d9797120f6b020888367986139f0a" data-lake-id="a73d9797120f6b020888367986139f0a" ne-alignment="left"><ne-code><ne-code-content><ne-text>caches</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="3d1892fa4ff7e187d76a7c493856e122" data-lake-id="3d1892fa4ff7e187d76a7c493856e122" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="938cd6511ed4002afae77120fe2af398" data-lake-id="938cd6511ed4002afae77120fe2af398" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="97600ae4823614281cd65d171ab3ba3e" data-lake-id="97600ae4823614281cd65d171ab3ba3e" ne-alignment="left"><ne-code><ne-code-content><ne-text>conditions</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="7bd274069a7600ce7f24a87e0b65ab1d" data-lake-id="7bd274069a7600ce7f24a87e0b65ab1d" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="3f770c7eca5ea63d278a3ec4a8f177ef" data-lake-id="3f770c7eca5ea63d278a3ec4a8f177ef" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="ea4aa50d82f950ae4020b2999f7bd7ed" data-lake-id="ea4aa50d82f950ae4020b2999f7bd7ed" ne-alignment="left"><ne-code><ne-code-content><ne-text>configprops</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="940b7c286eaed197fdf6c0553f26a590" data-lake-id="940b7c286eaed197fdf6c0553f26a590" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="1584394ced7100f855bd7019a3b6cce0" data-lake-id="1584394ced7100f855bd7019a3b6cce0" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="13af5bf0bed870a4ed2864bf705cb696" data-lake-id="13af5bf0bed870a4ed2864bf705cb696" ne-alignment="left"><ne-code><ne-code-content><ne-text>env</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="909f7e92bbb28f64dd5ac40e0c7d3c5b" data-lake-id="909f7e92bbb28f64dd5ac40e0c7d3c5b" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d814104151ab0538813bd62a6a10258f" data-lake-id="d814104151ab0538813bd62a6a10258f" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="4e962a7f2275da87b76aaca4600d9f86" data-lake-id="4e962a7f2275da87b76aaca4600d9f86" ne-alignment="left"><ne-code><ne-code-content><ne-text>flyway</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="7c4ae9bf697c54ceca6ff9f30150c8bb" data-lake-id="7c4ae9bf697c54ceca6ff9f30150c8bb" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="819f9bb978462ab6d80be3bbd24f1aa1" data-lake-id="819f9bb978462ab6d80be3bbd24f1aa1" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="0d562c25e63fd2fbbc2ec20b3d81ef2c" data-lake-id="0d562c25e63fd2fbbc2ec20b3d81ef2c" ne-alignment="left"><ne-code><ne-code-content><ne-text>health</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="f06d65923c7bf8ca8b352f4c01ac71fe" data-lake-id="f06d65923c7bf8ca8b352f4c01ac71fe" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e31fe3fee70d0e66072cf3c53c70e5b2" data-lake-id="e31fe3fee70d0e66072cf3c53c70e5b2" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d5c4cec788a6ea953f51cfb2e1210a5d" data-lake-id="d5c4cec788a6ea953f51cfb2e1210a5d" ne-alignment="left"><ne-code><ne-code-content><ne-text>heapdump</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d25ecf1a425d9363d19270eaf4928229" data-lake-id="d25ecf1a425d9363d19270eaf4928229" ne-alignment="left"><ne-text>N/A</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="7eb4357a573493726f8dcc0436b990a1" data-lake-id="7eb4357a573493726f8dcc0436b990a1" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="da757ce1f3beacf88de7405c338d9d2d" data-lake-id="da757ce1f3beacf88de7405c338d9d2d" ne-alignment="left"><ne-code><ne-code-content><ne-text>httptrace</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="8aa3ed92d88d123a738bd52479a85a25" data-lake-id="8aa3ed92d88d123a738bd52479a85a25" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="67796c3d148d7ea20dbda53edb6510eb" data-lake-id="67796c3d148d7ea20dbda53edb6510eb" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="479c38941ed1a00f01e0f68f908a2319" data-lake-id="479c38941ed1a00f01e0f68f908a2319" ne-alignment="left"><ne-code><ne-code-content><ne-text>info</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="b549c9febd46431d7aa56b86e0656ce2" data-lake-id="b549c9febd46431d7aa56b86e0656ce2" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="3ea4e1dbf21cad91b0f924fff1856b89" data-lake-id="3ea4e1dbf21cad91b0f924fff1856b89" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="b46b15da584faec2de66a04b0e6be63a" data-lake-id="b46b15da584faec2de66a04b0e6be63a" ne-alignment="left"><ne-code><ne-code-content><ne-text>integrationgraph</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="c156d11bb4af082c265cbbba4d0cd342" data-lake-id="c156d11bb4af082c265cbbba4d0cd342" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="36bf92b7a18e1f13f5d124f01149b2fd" data-lake-id="36bf92b7a18e1f13f5d124f01149b2fd" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d9f6e17558e049f7f7c381033adef804" data-lake-id="d9f6e17558e049f7f7c381033adef804" ne-alignment="left"><ne-code><ne-code-content><ne-text>jolokia</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d3169e43c677dd40d7e02a8589f77823" data-lake-id="d3169e43c677dd40d7e02a8589f77823" ne-alignment="left"><ne-text>N/A</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="584a3e9d562363c0c482d36109bcbcda" data-lake-id="584a3e9d562363c0c482d36109bcbcda" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="74f38df0cf4f5fca1e0a84b985b8b27d" data-lake-id="74f38df0cf4f5fca1e0a84b985b8b27d" ne-alignment="left"><ne-code><ne-code-content><ne-text>logfile</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="f85398e444080e0c9297636aef7c04de" data-lake-id="f85398e444080e0c9297636aef7c04de" ne-alignment="left"><ne-text>N/A</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e3857ce08741d187d6852671917e90d7" data-lake-id="e3857ce08741d187d6852671917e90d7" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="cd5328f213cfd4210fa4acc11f0cd14c" data-lake-id="cd5328f213cfd4210fa4acc11f0cd14c" ne-alignment="left"><ne-code><ne-code-content><ne-text>loggers</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="2fcdbceb9845326f6f9695b9d19c5810" data-lake-id="2fcdbceb9845326f6f9695b9d19c5810" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="72dda4e204ab789b849703b004b76442" data-lake-id="72dda4e204ab789b849703b004b76442" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="22bcd26ebda5f4126c115611aabe696d" data-lake-id="22bcd26ebda5f4126c115611aabe696d" ne-alignment="left"><ne-code><ne-code-content><ne-text>liquibase</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="564fa70c8dca35384f1304ce339cf405" data-lake-id="564fa70c8dca35384f1304ce339cf405" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="59dd5a1554d5f3a702c3c626db10adfb" data-lake-id="59dd5a1554d5f3a702c3c626db10adfb" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e528337e4a0f0350ebb70e9e8b80a6e9" data-lake-id="e528337e4a0f0350ebb70e9e8b80a6e9" ne-alignment="left"><ne-code><ne-code-content><ne-text>metrics</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="4369ed7cafaee30ecc061a1e23d11c47" data-lake-id="4369ed7cafaee30ecc061a1e23d11c47" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="4c5666ac091dcf77f0ffc578621cae3b" data-lake-id="4c5666ac091dcf77f0ffc578621cae3b" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d6fcec984eb0c50bf0c1890a528cdfa8" data-lake-id="d6fcec984eb0c50bf0c1890a528cdfa8" ne-alignment="left"><ne-code><ne-code-content><ne-text>mappings</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="508c7cf629504c90c83ff9d7804d3c30" data-lake-id="508c7cf629504c90c83ff9d7804d3c30" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="6b3d5df802c3a63d2271bbf82ac914ae" data-lake-id="6b3d5df802c3a63d2271bbf82ac914ae" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="a21d56e998b25f9cb3b0b45d43f0b2ca" data-lake-id="a21d56e998b25f9cb3b0b45d43f0b2ca" ne-alignment="left"><ne-code><ne-code-content><ne-text>prometheus</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="84ea1dd6eb7eea5e00da93e6f68774d1" data-lake-id="84ea1dd6eb7eea5e00da93e6f68774d1" ne-alignment="left"><ne-text>N/A</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="760b66ba7cf638966f665f9b7d210f71" data-lake-id="760b66ba7cf638966f665f9b7d210f71" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="4d60ab70f988e592c0f2048d175c1fb5" data-lake-id="4d60ab70f988e592c0f2048d175c1fb5" ne-alignment="left"><ne-code><ne-code-content><ne-text>scheduledtasks</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d7971399ea4d7df0d4961469120a167c" data-lake-id="d7971399ea4d7df0d4961469120a167c" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d056a516eede92b3ebc332a479abd92a" data-lake-id="d056a516eede92b3ebc332a479abd92a" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="c1f1d9e466d5f64c414c185d2ac9649c" data-lake-id="c1f1d9e466d5f64c414c185d2ac9649c" ne-alignment="left"><ne-code><ne-code-content><ne-text>sessions</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e71f8534780a8694bf708159a0872acc" data-lake-id="e71f8534780a8694bf708159a0872acc" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="133d59ea2340a50c76cd73d248fe8fa5" data-lake-id="133d59ea2340a50c76cd73d248fe8fa5" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="53ac406947f053cb9874589bc92f5ac0" data-lake-id="53ac406947f053cb9874589bc92f5ac0" ne-alignment="left"><ne-code><ne-code-content><ne-text>shutdown</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="5d7decaf6f96e8dddbfcb9687978d268" data-lake-id="5d7decaf6f96e8dddbfcb9687978d268" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="e43cef6e2894627c3a36677492bf181d" data-lake-id="e43cef6e2894627c3a36677492bf181d" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="efb9a571c5b60ffe8f1753347c5afa5b" data-lake-id="efb9a571c5b60ffe8f1753347c5afa5b" ne-alignment="left"><ne-code><ne-code-content><ne-text>startup</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="2fafc2d9130b6a97692d75ae68b491ec" data-lake-id="2fafc2d9130b6a97692d75ae68b491ec" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="c61032c0741ef390dd084b8ec1762893" data-lake-id="c61032c0741ef390dd084b8ec1762893" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr><tr class="ne-tr" style="height: 33px;"><td class="ne-td" data-col="0" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="39861fc9fc5fd37deba2e50747fe8082" data-lake-id="39861fc9fc5fd37deba2e50747fe8082" ne-alignment="left"><ne-code><ne-code-content><ne-text>threaddump</ne-text></ne-code-content></ne-code><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="1" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="f867a2f2b70fe47b57069fdcb322060d" data-lake-id="f867a2f2b70fe47b57069fdcb322060d" ne-alignment="left"><ne-text>Yes</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td><td class="ne-td" data-col="2" style="vertical-align: top;"><div class="ne-td-content"><ne-p id="d51abbd87b7478ce08c235ea90929f76" data-lake-id="d51abbd87b7478ce08c235ea90929f76" ne-alignment="left"><ne-text>No</ne-text><span class="ne-viewer-b-filler" ne-filler="block"><br></span></ne-p></div><div class="ne-td-break" contenteditable="false"></div></td></tr></tbody></table>



# 3、定制 Endpoint  

## 1、定制 Health 信息  

```java
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

@Component
public class MyHealthIndicator implements HealthIndicator {

    @Override
    public Health health() {
        int errorCode = check(); // perform some specific health check
        if (errorCode != 0) {
            return Health.down().withDetail("Error Code", errorCode).build();
        }
        return Health.up().build();
    }

}
构建Health
Health build = Health.down()
                .withDetail("msg", "error service")
                .withDetail("code", "500")
                .withException(new RuntimeException())
                .build();
```



```yaml
management:
    health:
      enabled: true
      show-details: always #总是显示详细信息。可显示每个模块的状态信息
```




```java
@Component
public class MyComHealthIndicator extends AbstractHealthIndicator {

    /**
     * 真实的检查方法
     * @param builder
     * @throws Exception
     */
    @Override
    protected void doHealthCheck(Health.Builder builder) throws Exception {
        //mongodb。  获取连接进行测试
        Map<String,Object> map = new HashMap<>();
        // 检查完成
        if(1 == 2){
//            builder.up(); //健康
            builder.status(Status.UP);
            map.put("count",1);
            map.put("ms",100);
        }else {
//            builder.down();
            builder.status(Status.OUT_OF_SERVICE);
            map.put("err","连接超时");
            map.put("ms",3000);
        }

        builder.withDetail("code",100)
                .withDetails(map);
    }
}
```

## 2、定制info信息  

常用两种方式  

### 1、编写配置文件  

```yaml
info:
  appName: boot-admin
  version: 2.0.1
  mavenProjectName: @project.artifactId@  #使用@@可以获取maven的pom文件值
  mavenProjectVersion: @project.version@
```

### 2、编写InfoContributor

```java
import java.util.Collections;
import org.springframework.boot.actuate.info.Info;
import org.springframework.boot.actuate.info.InfoContributor;
import org.springframework.stereotype.Component;

@Component
public class ExampleInfoContributor implements InfoContributor {

    @Override
    public void contribute(Info.Builder builder) {
        builder.withDetail("example",
                Collections.singletonMap("key", "value"));
    }

}
```

[http://localhost:8080/actuator/info](http://localhost:8080/actuator/info) 会输出以上方式返回的所有info信息  

## 3、定制Metrics信息  

### 1、SpringBoot支持自动适配的Metrics  

●JVM metrics, report utilization of: 
		○Various memory and buffer pools 
		○Statistics related to garbage collection 
		○Threads utilization 
		○Number of classes loaded/unloaded 
●CPU metrics 
●File descriptor metrics 
●Kafka consumer and producer metrics 
●Log4j2 metrics: record the number of events logged to Log4j2 at each level 
●Logback metrics: record the number of events logged to Logback at each level 
●Uptime metrics: report a gauge for uptime and a fixed gauge representing the application’s absolute start time 
●Tomcat metrics (server.tomcat.mbeanregistry.enabled must be set to true for all Tomcat metrics to be registered) 
●[Spring Integration](https://docs.spring.io/spring-integration/docs/5.4.1/reference/html/system-management.html#micrometer-integration) metrics  

### 2、增加定制Metrics

```java
class MyService{
    Counter counter;
    public MyService(MeterRegistry meterRegistry){
         counter = meterRegistry.counter("myservice.method.running.counter");
    }

    public void hello() {
        counter.increment();
    }
}


//也可以使用下面的方式
@Bean
MeterBinder queueSize(Queue queue) {
    return (registry) -> Gauge.builder("queueSize", queue::size).register(registry);
}
```

# 4、定制Endpoint

```plain
@Component
@Endpoint(id = "container")
public class DockerEndpoint {
    @ReadOperation
    public Map getDockerInfo(){
        return Collections.singletonMap("info","docker started...");
    }

    @WriteOperation
    private void restartDocker(){
        System.out.println("docker restarted....");
    }

}
```

场景：开发ReadinessEndpoint来管理程序是否就绪，或者LivenessEndpoint来管理程序是否存活；  
当然，这个也可以直接使用 [https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-kubernetes-probes](https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-kubernetes-probes)  
